import os
from fpdf import FPDF

# --- Configuration ---
OUTPUT_DIR = "HRbiz_Contracts_Proposals_Legal"
CLIENT_NAME = "Button Nose Grooming"
CLIENT_CONTACT = "Judy"
CONSULTANT_NAME = "HRbiz.org"
CONSULTANT_PERSON = "Mario Espindola, MPA"
NAVY = (26, 60, 94)
TEAL = (46, 139, 153)
SLATE = (74, 85, 104)

if not os.path.exists(OUTPUT_DIR):
   os.makedirs(OUTPUT_DIR)

class LegalPDF(FPDF):
   def header(self):
       # Branding Header
       self.set_font('Arial', 'B', 12)
       self.set_text_color(*NAVY)
       self.cell(0, 10, f'{CONSULTANT_NAME} | {CONSULTANT_PERSON}', 0, 1, 'R')
       self.set_draw_color(*TEAL)
       self.set_line_width(0.5)
       self.line(10, 20, 200, 20)
       self.ln(15)

   def footer(self):
       self.set_y(-15)
       self.set_font('Arial', 'I', 8)
       self.set_text_color(128)
       self.cell(0, 10, f'Page {self.page_no()} - Confidential & Proprietary - {CLIENT_NAME}', 0, 0, 'C')

   def doc_title(self, title):
       self.set_font('Arial', 'B', 18)
       self.set_text_color(*NAVY)
       self.cell(0, 10, title, 0, 1, 'L')
       self.ln(5)

   def section_header(self, title):
       self.ln(5)
       self.set_font('Arial', 'B', 12)
       self.set_text_color(*TEAL)
       self.cell(0, 10, title.upper(), 0, 1, 'L')
       self.set_text_color(*SLATE)

   def body_text(self, text):
       self.set_font('Arial', '', 10)
       self.set_text_color(*SLATE)
       self.multi_cell(0, 6, text)
       self.ln(3)

   def add_signature_block(self):
       self.ln(20)
       self.set_font('Arial', 'B', 10)
       self.cell(90, 10, "ACCEPTED BY CLIENT:", 0, 0)
       self.cell(90, 10, "ACCEPTED BY HRBIZ.ORG:", 0, 1)
       self.ln(15)
       self.cell(90, 5, "__________________________", 0, 0)
       self.cell(90, 5, "__________________________", 0, 1)
       self.set_font('Arial', '', 9)
       self.cell(90, 5, f"{CLIENT_CONTACT}, Owner", 0, 0)
       self.cell(90, 5, f"{CONSULTANT_PERSON}", 0, 1)
       self.ln(5)
       self.cell(90, 5, "Date: _______________", 0, 0)
       self.cell(90, 5, "Date: _______________", 0, 1)

# --- Document Generators ---

def generate_proposal():
   pdf = LegalPDF()
   pdf.add_page()
   pdf.doc_title("HR Compliance Proposal: Button Nose Grooming")
   
   pdf.section_header("1. Executive Summary")
   pdf.body_text(f"Button Nose Grooming requires a foundational HR compliance structure to meet California FEHA standards. This proposal outlines the deployment of an online Harassment Prevention Training system, a customized policy handbook, and essential recordkeeping protocols to mitigate liability.")
   
   pdf.section_header("2. Scope of Services")
   pdf.body_text("A. Harassment Prevention Training (Online Setup & Certification)\nB. Policy Development (Harassment, Retaliation, Safety)\nC. Compliance Forms Package (Complaints, Investigations, Logs)\nD. Mini-Handbook Creation (Introduction + Core Policies)\nE. Onboarding System (Checklists & New Hire Flow)")
   
   pdf.section_header("3. Implementation Timeline")
   pdf.body_text("Phase 1: Setup & Customization (Days 1-5)\nPhase 2: Training Launch (Days 6-10)\nPhase 3: Final Delivery & Handover (Day 14)")
   
   pdf.section_header("4. Fees")
   pdf.body_text("Please refer to the attached Fee Schedule for detailed breakdown.")
   
   pdf.add_signature_block()
   pdf.output(f"{OUTPUT_DIR}/HRbiz_proposal_button_nose.pdf")

def generate_msa():
   pdf = LegalPDF()
   pdf.add_page()
   pdf.doc_title("Master Services Agreement (MSA)")
   
   pdf.section_header("1. Services")
   pdf.body_text(f"{CONSULTANT_NAME} agrees to provide HR consulting services as described in the Scope of Services Addendum.")
   
   pdf.section_header("2. Nature of Relationship")
   pdf.body_text(f"{CONSULTANT_NAME} is an independent contractor. Nothing in this agreement creates an employer-employee relationship.")
   
   pdf.section_header("3. Limitations (No Legal/PI Advice)")
   pdf.body_text("Client acknowledges that Consultant is NOT an attorney and NOT a licensed Private Investigator. Services are for internal HR administrative support only. For legal advice or external investigations, Client must retain licensed counsel or investigators.")
   
   pdf.section_header("4. Confidentiality")
   pdf.body_text("Consultant agrees to keep all Client proprietary information confidential. Client agrees that Consultant's methodologies and templates remain the property of Consultant.")
   
   pdf.section_header("5. Governing Law")
   pdf.body_text("This agreement shall be governed by the laws of the State of California.")
   
   pdf.add_signature_block()
   pdf.output(f"{OUTPUT_DIR}/HRbiz_master_services_agreement.pdf")

def generate_fee_schedule():
   pdf = LegalPDF()
   pdf.add_page()
   pdf.doc_title("Fee Schedule - 2025")
   
   pdf.section_header("Consulting Services")
   pdf.body_text("Hourly HR Consulting Rate: $125.00 - $185.00 / hour\n(Rate depends on complexity of project)")
   
   pdf.section_header("Flat-Rate Packages")
   pdf.body_text("Compliance Starter Kit (Policies + Forms): $1,500.00\nHandbook Development (Core Module): $1,200.00\nOnboarding System Setup: $850.00")
   
   pdf.section_header("Training Services")
   pdf.body_text("Online Learning Portal Setup: $250.00 (One-time)\nPer-Employee License: $25.00 / user / year")
   
   pdf.section_header("Retainer Options")
   pdf.body_text("Monthly Support (up to 5 hours): $600.00 / month")
   
   pdf.output(f"{OUTPUT_DIR}/HRbiz_fee_schedule.pdf")

def generate_disclaimers_notices():
   # 1. PI License Notice
   pdf = LegalPDF()
   pdf.add_page()
   pdf.doc_title("NOTICE: Limitation of Services (PI License)")
   pdf.body_text("Under California Business & Professions Code, external investigations into employee misconduct for hire often require a Private Investigator (PI) license.\n\nHRbiz.org is NOT a licensed PI agency.\n\nOur role is limited to:\n1. Intake of complaints.\n2. Documentation of facts provided by employees.\n3. HR Policy guidance.\n\nWe cannot conduct surveillance, deep background checks, or external field investigations. If a case requires such scrutiny, we will refer you to a licensed PI.")
   pdf.add_signature_block()
   pdf.output(f"{OUTPUT_DIR}/HRbiz_PI_license_limitation_notice.pdf")

   # 2. Non-Legal Advice
   pdf = LegalPDF()
   pdf.add_page()
   pdf.doc_title("Disclaimer: Not Legal Advice")
   pdf.body_text("HRbiz.org provides Human Resources consulting based on best practices and administrative standards. We are not a law firm. No communication should be construed as legal advice or attorney-client privileged. For legal strategy, please Consult an Employment Attorney.")
   pdf.output(f"{OUTPUT_DIR}/HRbiz_disclaimers_and_limitations.pdf")

   # 3. Privacy Notice
   pdf = LegalPDF()
   pdf.add_page()
   pdf.doc_title("Privacy & Confidentiality Notice")
   pdf.body_text("We respect the privacy of your employees. Personnel files, medical notes, and investigation records are stored securely.\n\nHowever, in the event of a lawsuit or subpoena, HRbiz.org records may be discoverable. We do not hold 'Attorney-Client Privilege.'")
   pdf.output(f"{OUTPUT_DIR}/HRbiz_privacy_and_confidentiality_notice.pdf")

   # 4. Auth for External Investigator
   pdf = LegalPDF()
   pdf.add_page()
   pdf.doc_title("Authorization to Engage External Investigator")
   pdf.body_text("I, the undersigned Client, authorize HRbiz.org to coordinate with a licensed Private Investigator (PI) on my behalf regarding Case #_________.\n\nI understand that the PI is a separate entity and will bill separately.")
   pdf.add_signature_block()
   pdf.output(f"{OUTPUT_DIR}/HRbiz_authorization_to_engage_external_investigator.pdf")

def generate_forms_and_misc():
   # 1. New Client Cover
   pdf = LegalPDF()
   pdf.add_page()
   pdf.set_font('Arial', 'B', 24)
   pdf.set_text_color(*NAVY)
   pdf.cell(0, 40, "HR COMPLIANCE STARTUP PACKET", 0, 1, 'C')
   pdf.set_font('Arial', '', 14)
   pdf.cell(0, 10, "Prepared For:", 0, 1, 'C')
   pdf.set_font('Arial', 'B', 16)
   pdf.cell(0, 10, CLIENT_NAME, 0, 1, 'C')
   pdf.ln(20)
   pdf.set_font('Arial', '', 12)
   pdf.cell(0, 10, "Presented By: Mario Espindola, MPA", 0, 1, 'C')
   pdf.cell(0, 10, "HRbiz.org", 0, 1, 'C')
   pdf.output(f"{OUTPUT_DIR}/HRbiz_new_client_cover_page.pdf")

   # 2. Intake Form
   pdf = LegalPDF()
   pdf.add_page()
   pdf.doc_title("New Client Intake Form")
   pdf.body_text("Business Legal Name: ________________________________________________")
   pdf.body_text("DBA (if applicable): ________________________________________________")
   pdf.body_text("Federal EIN: ________________________  CA SEIN: _____________________")
   pdf.body_text("Total Employees: ________  (W2: _____  1099: _____ )")
   pdf.body_text("Payroll Provider: ___________________________________________________")
   pdf.body_text("Workers Comp Carrier: _______________________________________________")
   pdf.output(f"{OUTPUT_DIR}/HRbiz_client_intake_form.pdf")

   # 3. Invoice Template
   pdf = LegalPDF()
   pdf.add_page()
   pdf.doc_title("INVOICE")
   pdf.set_font('Arial', 'B', 12)
   pdf.cell(0, 10, "Invoice #: 2025-001", 0, 1, 'R')
   pdf.cell(0, 10, "Date: ____________", 0, 1, 'R')
   pdf.ln(10)
   pdf.set_fill_color(240, 240, 240)
   pdf.cell(100, 10, "Description", 1, 0, 'L', 1)
   pdf.cell(30, 10, "Hours", 1, 0, 'C', 1)
   pdf.cell(30, 10, "Rate", 1, 0, 'R', 1)
   pdf.cell(30, 10, "Total", 1, 1, 'R', 1)
   # Rows
   pdf.set_font('Arial', '', 10)
   pdf.cell(100, 10, "HR Compliance Setup", 1, 0)
   pdf.cell(30, 10, "-", 1, 0, 'C')
   pdf.cell(30, 10, "-", 1, 0, 'R')
   pdf.cell(30, 10, "$1,500.00", 1, 1, 'R')
   pdf.output(f"{OUTPUT_DIR}/HRbiz_invoice_template.pdf")

   # 4. Summary for Judy
   pdf = LegalPDF()
   pdf.add_page()
   pdf.doc_title("Your Compliance Plan: Simple Summary")
   pdf.body_text(f"Hi {CLIENT_CONTACT}, here is the plain-English version of what we are doing:\n\n1. Protecting You: We are setting up the training and forms required by California law so you don't get fined.\n2. Online Training: We will email your staff a link. They watch videos, answer questions, and get a certificate.\n3. Rules of the Road: We are giving you a 'Mini-Handbook' so everyone knows the rules about harassment, safety, and attendance.\n4. Paperwork: We are fixing your new-hire forms so you are legally covered from Day 1.\n\nEstimated Time: We can have this all live in 2 weeks.\n\nNext Step: Sign the proposal and we get to work!")
   pdf.output(f"{OUTPUT_DIR}/HRbiz_proposal_summary_for_judy.pdf")

   # 5. Engagement Letter
   pdf = LegalPDF()
   pdf.add_page()
   pdf.doc_title("Engagement Letter")
   pdf.body_text(f"Dear {CLIENT_CONTACT},\n\nThis letter confirms our agreement to provide HR consulting services to {CLIENT_NAME}. We are excited to assist you in building a compliant and positive workplace culture.\n\nPlease sign the attached Proposal and MSA to authorize the commencement of work.")
   pdf.add_signature_block()
   pdf.output(f"{OUTPUT_DIR}/HRbiz_engagement_letter.pdf")
   
   # 6. Liability Waiver
   pdf = LegalPDF()
   pdf.add_page()
   pdf.doc_title("Client Liability Waiver")
   pdf.body_text("Client agrees to indemnify and hold harmless HRbiz.org from any claims resulting from Client's failure to implement advice, or from inaccurate information provided by Client to Consultant.")
   pdf.add_signature_block()
   pdf.output(f"{OUTPUT_DIR}/HRbiz_liability_waiver.pdf")
   
   # 7. Scope Addendum
   pdf = LegalPDF()
   pdf.add_page()
   pdf.doc_title("Addendum A: Scope of Services")
   pdf.body_text("Specific Inclusions for Button Nose Grooming:\n- Review of 1099 vs W2 Groomer status.\n- Safety protocols for animal handling.\n- Spanish language translation of core policies (if required).")
   pdf.output(f"{OUTPUT_DIR}/HRbiz_service_scope_addendum.pdf")
   
   # 8. Retainer Agreement
   pdf = LegalPDF()
   pdf.add_page()
   pdf.doc_title("Retainer Agreement (Optional)")
   pdf.body_text("Client may opt into a monthly retainer for ongoing support.\n\nIncludes:\n- Unlimited text/email questions.\n- 1 hour of phone support/month.\n- Quarterly policy updates.")
   pdf.add_signature_block()
   pdf.output(f"{OUTPUT_DIR}/HRbiz_retainer_agreement.pdf")

if __name__ == "__main__":
   print(f"Generating Contracts & Legal Docs for {CLIENT_NAME}...")
   generate_proposal()
   generate_msa()
   generate_fee_schedule()
   generate_disclaimers_notices()
   generate_forms_and_misc()
   print(f"Success! All 15 documents created in {OUTPUT_DIR}/")

Deployment Instructions
1. Save the Script: Copy the code above into generate_contracts.py.
2. Run the Script:
python generate_contracts.py